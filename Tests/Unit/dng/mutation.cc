/*
 * Copyright (c) 2016 Steven H. Wu
 * Authors:  Steven H. Wu <stevenwu@asu.edu>
 *
 * This file is part of DeNovoGear.
 *
 * DeNovoGear is free software: you can redistribute it and/or modify it under
 * the terms of the GNU General Public License as published by the Free Software
 * Foundation; either version 3 of the License, or (at your option) any later
 * version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with
 * this program. If not, see <http://www.gnu.org/licenses/>.
 */


#define BOOST_TEST_MODULE dng::mutation

#include <iostream>

#include <dng/mutation.h>

#include "../boost_test_helper.h"

using namespace dng;

struct CreateMutationMatrix {

    std::string fixture;

    MutationMatrix equal_mutation_matrix;
    MutationMatrix unequal_mutation_matrix;
    std::array<double, 4> equal_freq = {{0.25, 0.25, 0.25, 0.25}};
    std::array<double, 4> unequal_freq = {{0.1, 0.2, 0.3, 0.4}};


    CreateMutationMatrix(std::string s = "CreateMutationMatrix") : fixture(s) {
        BOOST_TEST_MESSAGE("set up fixture: " << fixture);

        equal_mutation_matrix = f81::matrix(1e-6, equal_freq);
        unequal_mutation_matrix = f81::matrix(1e-6, unequal_freq);

    }

    ~CreateMutationMatrix() {
        BOOST_TEST_MESSAGE("tear down fixture: " << fixture);
    }


};

BOOST_FIXTURE_TEST_SUITE(test_f81_suite, CreateMutationMatrix )

BOOST_AUTO_TEST_CASE(test_f81_equal) {

    auto diag = equal_mutation_matrix.diagonal();
    std::vector<double> expected_diag = {0.999999, 0.999999, 0.999999, 0.999999};
    std::vector<double> expected_off_diag = {3.333331111e-07, 3.333331111e-07, 3.333331111e-07, 3.333331111e-07};

    boost_check_close_vector(expected_diag, diag);
    for (int i = 0; i < 4; ++i) {
        auto actual = equal_mutation_matrix.col(i);
        Eigen::Array4d expected = Eigen::Array4d::Constant(expected_off_diag[i]);
        expected(i) = expected_diag[i];
        boost_check_close_vector(expected, actual);
    }
}

BOOST_AUTO_TEST_CASE(test_f81) {

    auto diag = unequal_mutation_matrix.diagonal();
    std::vector<double> expected_diag = {0.9999987143, 0.9999988571, 0.9999990000, 0.9999991429};
    std::vector<double> expected_off_diag = {1.428570408e-07, 2.857140816e-07, 4.285711225e-07, 5.714281633e-07};


    boost_check_close_vector(expected_diag, diag);
    for (int i = 0; i < 4; ++i) {
        auto actual = unequal_mutation_matrix.col(i);
        Eigen::Array4d expected = Eigen::Array4d::Constant(expected_off_diag[i]);
        expected(i) = expected_diag[i];
        boost_check_close_vector(expected, actual);
    }
}

BOOST_AUTO_TEST_CASE(test_f81_random) {

    auto matrix = f81::matrix(1e-3, {0.01, 0.1, 0.19, 0.7});
    auto diag = matrix.diagonal();
    std::vector<double> expected_diag = {0.9978677587, 0.9980615989, 0.9982554390, 0.9993538663};
    std::vector<double> expected_off_diag = {0.0000215377905, 0.0002153779050, 0.0004092180195, 0.0015076453352};


    boost_check_close_vector(expected_diag, diag);
    for (int i = 0; i < 4; ++i) {
        auto actual = matrix.col(i);
        Eigen::Array4d expected = Eigen::Array4d::Constant(expected_off_diag[i]);
        expected(i) = expected_diag[i];
        boost_check_close_vector(expected, actual);
    }
}
BOOST_AUTO_TEST_SUITE_END()



BOOST_FIXTURE_TEST_SUITE(test_mutation_suite, CreateMutationMatrix )

BOOST_AUTO_TEST_CASE(test_mitosis_haploid_matrix) {


    TransitionMatrix expected_matrix_negative = TransitionMatrix::Zero(4, 4);
    for (int i = 0; i < 4; ++i) {
        for (int j = 0; j < 4; ++j) {
            expected_matrix_negative(i, j) = unequal_mutation_matrix(i, j);
        }
    }
    TransitionMatrix expected_matrix_negative_r = TransitionMatrix::Zero(4, 4);
    expected_matrix_negative_r <<
        0.999998714286633, 2.85714081638133e-07, 4.285711224572e-07, 5.71428163276266e-07,
        1.42857040819067e-07, 0.999998857143673, 4.285711224572e-07, 5.71428163276266e-07,
        1.42857040819067e-07, 2.85714081638133e-07, 0.999999000000714, 5.71428163276266e-07,
        1.42857040819067e-07, 2.85714081638133e-07, 4.285711224572e-07, 0.999999142857755;

    TransitionMatrix expected_copy_unequal_mutation_matrix = unequal_mutation_matrix;


    TransitionMatrix expected_matrix_zero = TransitionMatrix::Zero(4, 4);
    expected_matrix_zero.diagonal() = unequal_mutation_matrix.diagonal();
    TransitionMatrix expected_matrix_zero_r = TransitionMatrix::Zero(4, 4);
    expected_matrix_zero_r <<
            0.999998714286633, 0, 0, 0,
            0, 0.999998857143673, 0, 0,
            0, 0, 0.999999000000714, 0,
            0, 0, 0, 0.999999142857755;

    TransitionMatrix expected_matrix_one = unequal_mutation_matrix;
    expected_matrix_one.diagonal() = Eigen::Vector4d::Zero(4);

    TransitionMatrix expected_matrix_one_r =  TransitionMatrix::Zero(4, 4);
    expected_matrix_one_r <<
            0, 2.85714081638133e-07, 4.285711224572e-07, 5.71428163276266e-07,
            1.42857040819067e-07, 0, 4.285711224572e-07, 5.71428163276266e-07,
            1.42857040819067e-07, 2.85714081638133e-07, 0, 5.71428163276266e-07,
            1.42857040819067e-07, 2.85714081638133e-07, 4.285711224572e-07, 0;

    TransitionMatrix expected_matrix_two =  TransitionMatrix::Zero(4, 4);

    auto actual_negative = mitosis_haploid_matrix(unequal_mutation_matrix, -1);
    boost_check_matrix(expected_matrix_negative, actual_negative);
    boost_check_matrix(expected_matrix_negative_r, actual_negative);
    boost_check_matrix(expected_copy_unequal_mutation_matrix, actual_negative);

    auto actual_neg_2 = mitosis_haploid_matrix(unequal_mutation_matrix, -2);
    boost_check_matrix(expected_matrix_negative, actual_neg_2);
    boost_check_matrix(expected_matrix_negative_r, actual_neg_2);
    boost_check_matrix(expected_copy_unequal_mutation_matrix, actual_neg_2);

    auto actual_zero = mitosis_haploid_matrix(unequal_mutation_matrix, 0);
    boost_check_matrix(expected_matrix_zero, actual_zero);
    boost_check_matrix(expected_matrix_zero_r, actual_zero);

    auto actual_one = mitosis_haploid_matrix(unequal_mutation_matrix, 1);
    boost_check_matrix(expected_matrix_one, actual_one);
    boost_check_matrix(expected_matrix_one_r, actual_one);

    auto actual_two = mitosis_haploid_matrix(unequal_mutation_matrix, 2);
    boost_check_matrix(expected_matrix_two, actual_two);

}

BOOST_AUTO_TEST_CASE(test_mitosis_diploid_matrix) {


    TransitionMatrix expected_matrix_negative_cpp = TransitionMatrix::Zero(10, 10);
    auto kp = kroneckerProduct(unequal_mutation_matrix, unequal_mutation_matrix);
    for(int m = 0; m < 10; ++m) {
        int i = unfolded_diploid_genotypes_upper[m];
        for (int j = 0; j < 16; ++j) {
            int n = folded_diploid_genotypes[j];
            expected_matrix_negative_cpp(m, n) += kp.coeff(i, j);
        }
    }

    TransitionMatrix expected_matrix_negative = TransitionMatrix::Zero(10, 10);
    expected_matrix_negative
        << 0.999997428574918, 5.71427428583438e-07, 8.57141142875158e-07, 1.14285485716688e-06, 8.16325364463218e-14, 2.44897609338966e-13, 3.26530145785287e-13, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        1.4285685714586e-07, 0.999997571431816, 4.28570632661981e-07, 5.71427510215975e-07, 2.85713755107987e-07, 4.28570755110786e-07, 5.71427673481048e-07, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        1.4285685714586e-07, 2.85713755107987e-07, 0.999997714288694, 5.71427510215975e-07, 8.16325364463218e-14, 2.8571391837306e-07, 3.26530145785287e-13, 4.28570693886384e-07, 5.71427836746121e-07, 3.26530145785287e-13,
        1.4285685714586e-07, 2.85713755107987e-07, 4.28570632661981e-07, 0.999997857145571, 8.16325364463218e-14, 2.44897609338966e-13, 2.85714000005597e-07, 1.83673207004224e-13, 4.28571000008395e-07, 5.71427673481048e-07,
        2.04081341115805e-14, 2.85713755107987e-07, 1.22448804669483e-13, 1.63265072892644e-13, 0.999997714288653, 8.57141265323962e-07, 1.14285502043195e-06, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 1.42856918370262e-07, 1.4285695918653e-07, 1.63265072892644e-13, 2.85713755107987e-07, 0.999997857145653, 5.71427673481048e-07, 4.28570693886384e-07, 5.71427836746121e-07, 3.26530145785287e-13,
        2.04081341115805e-14, 1.42856918370262e-07, 1.22448804669483e-13, 1.42857000002798e-07, 2.85713755107987e-07, 4.28570755110786e-07, 0.999998000002571, 1.83673207004224e-13, 4.28571000008395e-07, 5.71427673481048e-07,
        2.04081341115805e-14, 8.16325364463218e-14, 2.85713795924256e-07, 1.63265072892644e-13, 8.16325364463218e-14, 5.71427591848511e-07, 3.26530145785287e-13, 0.999998000002429, 1.14285518369702e-06, 3.26530145785287e-13,
        2.04081341115805e-14, 8.16325364463218e-14, 1.4285695918653e-07, 1.42857000002798e-07, 8.16325364463218e-14, 2.8571391837306e-07, 2.85714000005597e-07, 4.28570693886384e-07, 0.999998142859571, 5.71427673481048e-07,
        2.04081341115805e-14, 8.16325364463218e-14, 1.22448804669483e-13, 2.85713836740524e-07, 8.16325364463218e-14, 2.44897609338966e-13, 5.71427673481048e-07, 1.83673207004224e-13, 8.57141510221572e-07, 0.999998285716245;

    TransitionMatrix expected_matrix_zero = TransitionMatrix::Zero(10, 10);
    expected_matrix_zero
        << 0.999997428574918, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0.999997571431775, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0.999997714288633, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0.99999785714549, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0.999997714288653, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0.999997857145531, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0.999998000002408, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0.999998000002429, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0.999998142859326, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0.999998285716245;

    TransitionMatrix expected_matrix_one = TransitionMatrix::Zero(10, 10);
    expected_matrix_one
        << 0, 5.71427428583438e-07, 8.57141142875158e-07, 1.14285485716688e-06, 0, 0, 0, 0, 0, 0,
        1.4285685714586e-07, 0, 4.28570571437579e-07, 5.71427428583438e-07, 2.85713755107987e-07, 4.28570632661981e-07, 5.71427510215975e-07, 0, 0, 0,
        1.4285685714586e-07, 2.85713714291719e-07, 0, 5.71427428583438e-07, 0, 2.85713795924256e-07, 0, 4.28570693886384e-07, 5.71427591848511e-07, 0,
        1.4285685714586e-07, 2.85713714291719e-07, 4.28570571437579e-07, 0, 0, 0, 2.85713836740524e-07, 0, 4.28570755110786e-07, 5.71427673481048e-07,
        0, 2.85713755107987e-07, 0, 0, 0, 8.57141265323962e-07, 1.14285502043195e-06, 0, 0, 0,
        0, 1.42856877553994e-07, 1.42856897962128e-07, 0, 2.85713755107987e-07, 0, 5.71427510215975e-07, 4.28570693886384e-07, 5.71427591848511e-07, 0,
        0, 1.42856877553994e-07, 0, 1.42856918370262e-07, 2.85713755107987e-07, 4.28570632661981e-07, 0, 0, 4.28570755110786e-07, 5.71427673481048e-07,
        0, 0, 2.85713795924256e-07, 0, 0, 5.71427591848511e-07, 0, 0, 1.14285518369702e-06, 0,
        0, 0, 1.42856897962128e-07, 1.42856918370262e-07, 0, 2.85713795924256e-07, 2.85713836740524e-07, 4.28570693886384e-07, 0, 5.71427673481048e-07,
        0, 0, 0, 2.85713836740524e-07, 0, 0, 5.71427673481048e-07, 0, 8.57141510221572e-07, 0;

    TransitionMatrix expected_matrix_two = TransitionMatrix::Zero(10, 10);
    expected_matrix_two
        << 0, 0, 0, 0, 8.16325364463218e-14, 2.44897609338966e-13, 3.26530145785287e-13, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 0, 1.22448804669483e-13, 1.63265072892644e-13, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.22448804669483e-13, 3.26530145785287e-13, 0, 2.44897609338966e-13, 3.26530145785287e-13,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 2.44897609338966e-13, 1.63265072892644e-13, 1.83673207004224e-13, 2.44897609338966e-13, 0,
        2.04081341115805e-14, 0, 1.22448804669483e-13, 1.63265072892644e-13, 0, 0, 0, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 4.08162682231609e-14, 6.12244023347414e-14, 1.63265072892644e-13, 0, 1.22448804669483e-13, 1.63265072892644e-13, 0, 2.44897609338966e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 4.08162682231609e-14, 1.22448804669483e-13, 8.16325364463218e-14, 0, 1.22448804669483e-13, 1.63265072892644e-13, 1.83673207004224e-13, 2.44897609338966e-13, 0,
        2.04081341115805e-14, 8.16325364463218e-14, 0, 1.63265072892644e-13, 8.16325364463218e-14, 0, 3.26530145785287e-13, 0, 0, 3.26530145785287e-13,
        2.04081341115805e-14, 8.16325364463218e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.22448804669483e-13, 1.63265072892644e-13, 0, 2.44897609338966e-13, 0,
        2.04081341115805e-14, 8.16325364463218e-14, 1.22448804669483e-13, 0, 8.16325364463218e-14, 2.44897609338966e-13, 0, 1.83673207004224e-13, 0, 0;

    TransitionMatrix expected_matrix_three = TransitionMatrix::Zero(10, 10);


    auto actual_negative = mitosis_diploid_matrix(unequal_mutation_matrix, -1);
    boost_check_matrix(expected_matrix_negative_cpp, actual_negative);
    boost_check_matrix(expected_matrix_negative, actual_negative);

    auto actual_zero = mitosis_diploid_matrix(unequal_mutation_matrix, 0);
    boost_check_matrix(expected_matrix_zero, actual_zero);

    auto actual_one = mitosis_diploid_matrix(unequal_mutation_matrix, 1);
    boost_check_matrix(expected_matrix_one, actual_one);

    auto actual_two = mitosis_diploid_matrix(unequal_mutation_matrix, 2);
    boost_check_matrix(expected_matrix_two, actual_two);

    auto actual_three = mitosis_diploid_matrix(unequal_mutation_matrix, 3);
    boost_check_matrix(expected_matrix_three, actual_three);
}

BOOST_AUTO_TEST_CASE(test_meiosis_haploid_matrix) {

    TransitionMatrix expected_matrix_negative = TransitionMatrix::Zero(10, 4);
    expected_matrix_negative
        << 0.999998714286633, 2.85714081638133e-07, 4.285711224572e-07, 5.71428163276266e-07,
        0.499999428571837, 0.499999571428878, 4.285711224572e-07, 5.71428163276266e-07,
        0.499999428571837, 2.85714081638133e-07, 0.499999714285918, 5.71428163276266e-07,
        0.499999428571837, 2.85714081638133e-07, 4.285711224572e-07, 0.499999857142959,
        1.42857040819067e-07, 0.999998857143673, 4.285711224572e-07, 5.71428163276266e-07,
        1.42857040819067e-07, 0.499999571428878, 0.499999714285918, 5.71428163276266e-07,
        1.42857040819067e-07, 0.499999571428878, 4.285711224572e-07, 0.499999857142959,
        1.42857040819067e-07, 2.85714081638133e-07, 0.999999000000714, 5.71428163276266e-07,
        1.42857040819067e-07, 2.85714081638133e-07, 0.499999714285918, 0.499999857142959,
        1.42857040819067e-07, 2.85714081638133e-07, 4.285711224572e-07, 0.999999142857755;



    TransitionMatrix expected_matrix_zero = TransitionMatrix::Zero(10, 4);
    expected_matrix_zero
        << 0.999998714286633, 0, 0, 0,
        0.499999357143316, 0.499999428571837, 0, 0,
        0.499999357143316, 0, 0.499999500000357, 0,
        0.499999357143316, 0, 0, 0.499999571428878,
        0, 0.999998857143673, 0, 0,
        0, 0.499999428571837, 0.499999500000357, 0,
        0, 0.499999428571837, 0, 0.499999571428878,
        0, 0, 0.999999000000714, 0,
        0, 0, 0.499999500000357, 0.499999571428878,
        0, 0, 0, 0.999999142857755;


    TransitionMatrix expected_matrix_one = TransitionMatrix::Zero(10, 4);
    expected_matrix_one
        << 0, 2.85714081638133e-07, 4.285711224572e-07, 5.71428163276266e-07,
        7.14285204095333e-08, 1.42857040819067e-07, 4.285711224572e-07, 5.71428163276266e-07,
        7.14285204095333e-08, 2.85714081638133e-07, 2.142855612286e-07, 5.71428163276266e-07,
        7.14285204095333e-08, 2.85714081638133e-07, 4.285711224572e-07, 2.85714081638133e-07,
        1.42857040819067e-07, 0, 4.285711224572e-07, 5.71428163276266e-07,
        1.42857040819067e-07, 1.42857040819067e-07, 2.142855612286e-07, 5.71428163276266e-07,
        1.42857040819067e-07, 1.42857040819067e-07, 4.285711224572e-07, 2.85714081638133e-07,
        1.42857040819067e-07, 2.85714081638133e-07, 0, 5.71428163276266e-07,
        1.42857040819067e-07, 2.85714081638133e-07, 2.142855612286e-07, 2.85714081638133e-07,
        1.42857040819067e-07, 2.85714081638133e-07, 4.285711224572e-07, 0;

    TransitionMatrix expected_matrix_two = TransitionMatrix::Zero(10, 4);


    auto actual_negative = meiosis_haploid_matrix(unequal_mutation_matrix, -1);
    boost_check_matrix(expected_matrix_negative, actual_negative);

    auto actual_zero = meiosis_haploid_matrix(unequal_mutation_matrix, 0);
    boost_check_matrix(expected_matrix_zero, actual_zero);

    auto actual_one = meiosis_haploid_matrix(unequal_mutation_matrix, 1);
    boost_check_matrix(expected_matrix_one, actual_one);

    auto actual_two = meiosis_haploid_matrix(unequal_mutation_matrix, 2);
    boost_check_matrix(expected_matrix_two, actual_two);
}


BOOST_AUTO_TEST_CASE(test_meiosis_diploid_matrix) {
    TransitionMatrix expected_matrix_negative = TransitionMatrix::Zero(100, 10);
    expected_matrix_negative
        << 0.999997428574918, 5.71427428583438e-07, 8.57141142875158e-07, 1.14285485716688e-06, 8.16325364463218e-14, 2.44897609338966e-13, 3.26530145785287e-13, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        0.499998785715888, 0.499999071429622, 6.42855887768569e-07, 8.57141183691426e-07, 1.42856918370262e-07, 2.14285500004198e-07, 2.85714000005597e-07, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        0.499998785715888, 4.28570591845713e-07, 0.499999285714918, 8.57141183691426e-07, 8.16325364463218e-14, 1.42857081635335e-07, 3.26530145785287e-13, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        0.499998785715888, 4.28570591845713e-07, 6.42855887768569e-07, 0.499999500000214, 8.16325364463218e-14, 2.44897609338966e-13, 1.42857163267871e-07, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        1.4285685714586e-07, 0.999997571431816, 4.28570632661981e-07, 5.71427510215975e-07, 2.85713755107987e-07, 4.28570755110786e-07, 5.71427673481048e-07, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        1.4285685714586e-07, 0.499998928572786, 0.499999071429663, 5.71427510215975e-07, 1.42856918370262e-07, 3.57142336741923e-07, 2.85714000005597e-07, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        1.4285685714586e-07, 0.499998928572786, 4.28570632661981e-07, 0.499999214286541, 1.42856918370262e-07, 2.14285500004198e-07, 4.28570836743322e-07, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        1.4285685714586e-07, 2.85713755107987e-07, 0.999997714288694, 5.71427510215975e-07, 8.16325364463218e-14, 2.8571391837306e-07, 3.26530145785287e-13, 4.28570693886384e-07, 5.71427836746121e-07, 3.26530145785287e-13,
        1.4285685714586e-07, 2.85713755107987e-07, 0.499999071429663, 0.499999214286541, 8.16325364463218e-14, 1.42857081635335e-07, 1.42857163267871e-07, 2.14285438779795e-07, 4.99999418377258e-07, 2.85714000005597e-07,
        1.4285685714586e-07, 2.85713755107987e-07, 4.28570632661981e-07, 0.999997857145571, 8.16325364463218e-14, 2.44897609338966e-13, 2.85714000005597e-07, 1.83673207004224e-13, 4.28571000008395e-07, 5.71427673481048e-07,
        0.499998785715888, 0.499999071429622, 6.42855887768569e-07, 8.57141183691426e-07, 1.42856918370262e-07, 2.14285500004198e-07, 2.85714000005597e-07, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        0.249999428572163, 0.499999000001204, 4.28570632661981e-07, 5.71427510215975e-07, 0.249999571429061, 4.28570755110786e-07, 5.71427673481048e-07, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        0.249999428572163, 0.24999964285748, 0.249999785714357, 5.71427510215975e-07, 1.42856918370262e-07, 0.249999642857643, 2.85714000005597e-07, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        0.249999428572163, 0.24999964285748, 4.28570632661981e-07, 0.249999928571235, 1.42856918370262e-07, 2.14285500004198e-07, 0.249999714286143, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        7.14284387769969e-08, 0.499998928572786, 2.14285377555393e-07, 2.85713836740524e-07, 0.499999000001204, 6.42856010217374e-07, 8.57141346956499e-07, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        7.14284387769969e-08, 0.249999571429061, 0.249999571429102, 2.85713836740524e-07, 0.249999571429061, 0.249999857142898, 5.71427673481048e-07, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 0.249999571429061, 2.14285377555393e-07, 0.249999642857561, 0.249999571429061, 4.28570755110786e-07, 0.249999999999816, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        7.14284387769969e-08, 2.14285336739125e-07, 0.499998928572827, 2.85713836740524e-07, 1.42856918370262e-07, 0.499999071429786, 2.85714000005597e-07, 4.28570693886384e-07, 5.71427836746121e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 2.14285336739125e-07, 0.249999571429102, 0.249999642857561, 1.42856918370262e-07, 0.249999642857643, 0.249999714286143, 2.14285438779795e-07, 4.99999418377258e-07, 2.85714000005597e-07,
        7.14284387769969e-08, 2.14285336739125e-07, 2.14285377555393e-07, 0.499999000001286, 1.42856918370262e-07, 2.14285500004198e-07, 0.499999142858286, 1.83673207004224e-13, 4.28571000008395e-07, 5.71427673481048e-07,
        0.499998785715888, 4.28570591845713e-07, 0.499999285714918, 8.57141183691426e-07, 8.16325364463218e-14, 1.42857081635335e-07, 3.26530145785287e-13, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        0.249999428572163, 0.24999964285748, 0.249999785714357, 5.71427510215975e-07, 1.42856918370262e-07, 0.249999642857643, 2.85714000005597e-07, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        0.249999428572163, 2.85713755107987e-07, 0.499999142858082, 5.71427510215975e-07, 8.16325364463218e-14, 2.8571391837306e-07, 3.26530145785287e-13, 0.249999714286, 5.71427836746121e-07, 3.26530145785287e-13,
        0.249999428572163, 2.85713755107987e-07, 0.249999785714357, 0.249999928571235, 8.16325364463218e-14, 1.42857081635335e-07, 1.42857163267871e-07, 2.14285438779795e-07, 0.249999785714724, 2.85714000005597e-07,
        7.14284387769969e-08, 0.499998857144367, 2.85713795924256e-07, 2.85713836740524e-07, 2.85713755107987e-07, 0.499999142858204, 5.71427673481048e-07, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 0.249999500000643, 0.24999964285752, 2.85713836740524e-07, 1.42856918370262e-07, 0.24999978571448, 2.85714000005597e-07, 0.249999714286, 5.71427836746121e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 0.249999500000643, 2.85713795924256e-07, 0.249999642857561, 1.42856918370262e-07, 0.249999642857643, 4.28570836743322e-07, 2.14285438779795e-07, 0.249999785714724, 2.85714000005597e-07,
        7.14284387769969e-08, 1.42856918370262e-07, 0.499999000001245, 2.85713836740524e-07, 8.16325364463218e-14, 4.28570755110786e-07, 3.26530145785287e-13, 0.499999214286561, 8.57141510221572e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 1.42856918370262e-07, 0.24999964285752, 0.249999642857561, 8.16325364463218e-14, 2.8571391837306e-07, 1.42857163267871e-07, 0.249999714286, 0.250000071428398, 2.85714000005597e-07,
        7.14284387769969e-08, 1.42856918370262e-07, 2.85713795924256e-07, 0.499999000001286, 8.16325364463218e-14, 1.42857081635335e-07, 2.85714000005597e-07, 2.14285438779795e-07, 0.499999285715286, 5.71427673481048e-07,
        0.499998785715888, 4.28570591845713e-07, 6.42855887768569e-07, 0.499999500000214, 8.16325364463218e-14, 2.44897609338966e-13, 1.42857163267871e-07, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        0.249999428572163, 0.24999964285748, 4.28570632661981e-07, 0.249999928571235, 1.42856918370262e-07, 2.14285500004198e-07, 0.249999714286143, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        0.249999428572163, 2.85713755107987e-07, 0.249999785714357, 0.249999928571235, 8.16325364463218e-14, 1.42857081635335e-07, 1.42857163267871e-07, 2.14285438779795e-07, 0.249999785714724, 2.85714000005597e-07,
        0.249999428572163, 2.85713755107987e-07, 4.28570632661981e-07, 0.499999285714959, 8.16325364463218e-14, 2.44897609338966e-13, 2.85714000005597e-07, 1.83673207004224e-13, 4.28571000008395e-07, 0.24999985714298,
        7.14284387769969e-08, 0.499998857144367, 2.14285377555393e-07, 3.57142255109387e-07, 2.85713755107987e-07, 4.28570755110786e-07, 0.499999285715122, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        7.14284387769969e-08, 0.249999500000643, 0.249999571429102, 3.57142255109387e-07, 1.42856918370262e-07, 3.57142336741923e-07, 0.249999714286143, 2.14285438779795e-07, 0.249999785714724, 2.85714000005597e-07,
        7.14284387769969e-08, 0.249999500000643, 2.14285377555393e-07, 0.24999971428598, 1.42856918370262e-07, 2.14285500004198e-07, 0.24999985714298, 1.83673207004224e-13, 4.28571000008395e-07, 0.24999985714298,
        7.14284387769969e-08, 1.42856918370262e-07, 0.499998928572827, 3.57142255109387e-07, 8.16325364463218e-14, 2.8571391837306e-07, 1.42857163267871e-07, 4.28570693886384e-07, 0.499999357143704, 2.85714000005597e-07,
        7.14284387769969e-08, 1.42856918370262e-07, 0.249999571429102, 0.24999971428598, 8.16325364463218e-14, 1.42857081635335e-07, 2.85714000005597e-07, 2.14285438779795e-07, 0.24999999999998, 0.24999985714298,
        7.14284387769969e-08, 1.42856918370262e-07, 2.14285377555393e-07, 0.499999071429704, 8.16325364463218e-14, 2.44897609338966e-13, 4.28570836743322e-07, 1.83673207004224e-13, 6.42856255114983e-07, 0.499999428571959,
        1.4285685714586e-07, 0.999997571431816, 4.28570632661981e-07, 5.71427510215975e-07, 2.85713755107987e-07, 4.28570755110786e-07, 5.71427673481048e-07, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        7.14284387769969e-08, 0.499998928572786, 2.14285377555393e-07, 2.85713836740524e-07, 0.499999000001204, 6.42856010217374e-07, 8.57141346956499e-07, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        7.14284387769969e-08, 0.499998857144367, 2.85713795924256e-07, 2.85713836740524e-07, 2.85713755107987e-07, 0.499999142858204, 5.71427673481048e-07, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 0.499998857144367, 2.14285377555393e-07, 3.57142255109387e-07, 2.85713755107987e-07, 4.28570755110786e-07, 0.499999285715122, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        2.04081341115805e-14, 2.85713755107987e-07, 1.22448804669483e-13, 1.63265072892644e-13, 0.999997714288653, 8.57141265323962e-07, 1.14285502043195e-06, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 2.14285336739125e-07, 7.14285408176674e-08, 1.63265072892644e-13, 0.499999000001204, 0.499999357143459, 8.57141346956499e-07, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        2.04081341115805e-14, 2.14285336739125e-07, 1.22448804669483e-13, 7.14285816339356e-08, 0.499999000001204, 6.42856010217374e-07, 0.499999571428796, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        2.04081341115805e-14, 1.42856918370262e-07, 1.4285695918653e-07, 1.63265072892644e-13, 2.85713755107987e-07, 0.999997857145653, 5.71427673481048e-07, 4.28570693886384e-07, 5.71427836746121e-07, 3.26530145785287e-13,
        2.04081341115805e-14, 1.42856918370262e-07, 7.14285408176674e-08, 7.14285816339356e-08, 2.85713755107987e-07, 0.499999142858204, 0.499999285715122, 2.14285438779795e-07, 4.99999418377258e-07, 2.85714000005597e-07,
        2.04081341115805e-14, 1.42856918370262e-07, 1.22448804669483e-13, 1.42857000002798e-07, 2.85713755107987e-07, 4.28570755110786e-07, 0.999998000002571, 1.83673207004224e-13, 4.28571000008395e-07, 5.71427673481048e-07,
        1.4285685714586e-07, 0.499998928572786, 0.499999071429663, 5.71427510215975e-07, 1.42856918370262e-07, 3.57142336741923e-07, 2.85714000005597e-07, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 0.249999571429061, 0.249999571429102, 2.85713836740524e-07, 0.249999571429061, 0.249999857142898, 5.71427673481048e-07, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 0.249999500000643, 0.24999964285752, 2.85713836740524e-07, 1.42856918370262e-07, 0.24999978571448, 2.85714000005597e-07, 0.249999714286, 5.71427836746121e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 0.249999500000643, 0.249999571429102, 3.57142255109387e-07, 1.42856918370262e-07, 3.57142336741923e-07, 0.249999714286143, 2.14285438779795e-07, 0.249999785714724, 2.85714000005597e-07,
        2.04081341115805e-14, 2.14285336739125e-07, 7.14285408176674e-08, 1.63265072892644e-13, 0.499999000001204, 0.499999357143459, 8.57141346956499e-07, 2.14285438779795e-07, 2.8571416327067e-07, 3.26530145785287e-13,
        2.04081341115805e-14, 1.42856918370262e-07, 1.4285695918653e-07, 1.63265072892644e-13, 0.249999571429061, 0.499999285715041, 5.71427673481048e-07, 0.249999714286, 5.71427836746121e-07, 3.26530145785287e-13,
        2.04081341115805e-14, 1.42856918370262e-07, 7.14285408176674e-08, 7.14285816339356e-08, 0.249999571429061, 0.249999857142898, 0.249999999999816, 2.14285438779795e-07, 0.249999785714724, 2.85714000005597e-07,
        2.04081341115805e-14, 7.14285000013992e-08, 2.14285377555393e-07, 1.63265072892644e-13, 1.42856918370262e-07, 0.499999214286622, 2.85714000005597e-07, 0.499999214286561, 8.57141510221572e-07, 3.26530145785287e-13,
        2.04081341115805e-14, 7.14285000013992e-08, 1.4285695918653e-07, 7.14285816339356e-08, 1.42856918370262e-07, 0.24999978571448, 0.249999714286143, 0.249999714286, 0.250000071428398, 2.85714000005597e-07,
        2.04081341115805e-14, 7.14285000013992e-08, 7.14285408176674e-08, 1.42857000002798e-07, 1.42856918370262e-07, 3.57142336741923e-07, 0.499999142858286, 2.14285438779795e-07, 0.499999285715286, 5.71427673481048e-07,
        1.4285685714586e-07, 0.499998928572786, 4.28570632661981e-07, 0.499999214286541, 1.42856918370262e-07, 2.14285500004198e-07, 4.28570836743322e-07, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        7.14284387769969e-08, 0.249999571429061, 2.14285377555393e-07, 0.249999642857561, 0.249999571429061, 4.28570755110786e-07, 0.249999999999816, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        7.14284387769969e-08, 0.249999500000643, 2.85713795924256e-07, 0.249999642857561, 1.42856918370262e-07, 0.249999642857643, 4.28570836743322e-07, 2.14285438779795e-07, 0.249999785714724, 2.85714000005597e-07,
        7.14284387769969e-08, 0.249999500000643, 2.14285377555393e-07, 0.24999971428598, 1.42856918370262e-07, 2.14285500004198e-07, 0.24999985714298, 1.83673207004224e-13, 4.28571000008395e-07, 0.24999985714298,
        2.04081341115805e-14, 2.14285336739125e-07, 1.22448804669483e-13, 7.14285816339356e-08, 0.499999000001204, 6.42856010217374e-07, 0.499999571428796, 1.83673207004224e-13, 2.14285744901807e-07, 2.85714000005597e-07,
        2.04081341115805e-14, 1.42856918370262e-07, 7.14285408176674e-08, 7.14285816339356e-08, 0.249999571429061, 0.249999857142898, 0.249999999999816, 2.14285438779795e-07, 0.249999785714724, 2.85714000005597e-07,
        2.04081341115805e-14, 1.42856918370262e-07, 1.22448804669483e-13, 1.42857000002798e-07, 0.249999571429061, 4.28570755110786e-07, 0.499999428571959, 1.83673207004224e-13, 4.28571000008395e-07, 0.24999985714298,
        2.04081341115805e-14, 7.14285000013992e-08, 1.4285695918653e-07, 7.14285816339356e-08, 1.42856918370262e-07, 0.499999071429786, 4.28570836743322e-07, 4.28570693886384e-07, 0.499999357143704, 2.85714000005597e-07,
        2.04081341115805e-14, 7.14285000013992e-08, 7.14285408176674e-08, 1.42857000002798e-07, 1.42856918370262e-07, 0.249999642857643, 0.24999985714298, 2.14285438779795e-07, 0.24999999999998, 0.24999985714298,
        2.04081341115805e-14, 7.14285000013992e-08, 1.22448804669483e-13, 2.14285418371661e-07, 1.42856918370262e-07, 2.14285500004198e-07, 0.499999285715122, 1.83673207004224e-13, 6.42856255114983e-07, 0.499999428571959,
        1.4285685714586e-07, 2.85713755107987e-07, 0.999997714288694, 5.71427510215975e-07, 8.16325364463218e-14, 2.8571391837306e-07, 3.26530145785287e-13, 4.28570693886384e-07, 5.71427836746121e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 2.14285336739125e-07, 0.499998928572827, 2.85713836740524e-07, 1.42856918370262e-07, 0.499999071429786, 2.85714000005597e-07, 4.28570693886384e-07, 5.71427836746121e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 1.42856918370262e-07, 0.499999000001245, 2.85713836740524e-07, 8.16325364463218e-14, 4.28570755110786e-07, 3.26530145785287e-13, 0.499999214286561, 8.57141510221572e-07, 3.26530145785287e-13,
        7.14284387769969e-08, 1.42856918370262e-07, 0.499998928572827, 3.57142255109387e-07, 8.16325364463218e-14, 2.8571391837306e-07, 1.42857163267871e-07, 4.28570693886384e-07, 0.499999357143704, 2.85714000005597e-07,
        2.04081341115805e-14, 1.42856918370262e-07, 1.4285695918653e-07, 1.63265072892644e-13, 2.85713755107987e-07, 0.999997857145653, 5.71427673481048e-07, 4.28570693886384e-07, 5.71427836746121e-07, 3.26530145785287e-13,
        2.04081341115805e-14, 7.14285000013992e-08, 2.14285377555393e-07, 1.63265072892644e-13, 1.42856918370262e-07, 0.499999214286622, 2.85714000005597e-07, 0.499999214286561, 8.57141510221572e-07, 3.26530145785287e-13,
        2.04081341115805e-14, 7.14285000013992e-08, 1.4285695918653e-07, 7.14285816339356e-08, 1.42856918370262e-07, 0.499999071429786, 4.28570836743322e-07, 4.28570693886384e-07, 0.499999357143704, 2.85714000005597e-07,
        2.04081341115805e-14, 8.16325364463218e-14, 2.85713795924256e-07, 1.63265072892644e-13, 8.16325364463218e-14, 5.71427591848511e-07, 3.26530145785287e-13, 0.999998000002429, 1.14285518369702e-06, 3.26530145785287e-13,
        2.04081341115805e-14, 8.16325364463218e-14, 2.14285377555393e-07, 7.14285816339356e-08, 8.16325364463218e-14, 4.28570755110786e-07, 1.42857163267871e-07, 0.499999214286561, 0.499999642857377, 2.85714000005597e-07,
        2.04081341115805e-14, 8.16325364463218e-14, 1.4285695918653e-07, 1.42857000002798e-07, 8.16325364463218e-14, 2.8571391837306e-07, 2.85714000005597e-07, 4.28570693886384e-07, 0.999998142859571, 5.71427673481048e-07,
        1.4285685714586e-07, 2.85713755107987e-07, 0.499999071429663, 0.499999214286541, 8.16325364463218e-14, 1.42857081635335e-07, 1.42857163267871e-07, 2.14285438779795e-07, 4.99999418377258e-07, 2.85714000005597e-07,
        7.14284387769969e-08, 2.14285336739125e-07, 0.249999571429102, 0.249999642857561, 1.42856918370262e-07, 0.249999642857643, 0.249999714286143, 2.14285438779795e-07, 4.99999418377258e-07, 2.85714000005597e-07,
        7.14284387769969e-08, 1.42856918370262e-07, 0.24999964285752, 0.249999642857561, 8.16325364463218e-14, 2.8571391837306e-07, 1.42857163267871e-07, 0.249999714286, 0.250000071428398, 2.85714000005597e-07,
        7.14284387769969e-08, 1.42856918370262e-07, 0.249999571429102, 0.24999971428598, 8.16325364463218e-14, 1.42857081635335e-07, 2.85714000005597e-07, 2.14285438779795e-07, 0.24999999999998, 0.24999985714298,
        2.04081341115805e-14, 1.42856918370262e-07, 7.14285408176674e-08, 7.14285816339356e-08, 2.85713755107987e-07, 0.499999142858204, 0.499999285715122, 2.14285438779795e-07, 4.99999418377258e-07, 2.85714000005597e-07,
        2.04081341115805e-14, 7.14285000013992e-08, 1.4285695918653e-07, 7.14285816339356e-08, 1.42856918370262e-07, 0.24999978571448, 0.249999714286143, 0.249999714286, 0.250000071428398, 2.85714000005597e-07,
        2.04081341115805e-14, 7.14285000013992e-08, 7.14285408176674e-08, 1.42857000002798e-07, 1.42856918370262e-07, 0.249999642857643, 0.24999985714298, 2.14285438779795e-07, 0.24999999999998, 0.24999985714298,
        2.04081341115805e-14, 8.16325364463218e-14, 2.14285377555393e-07, 7.14285816339356e-08, 8.16325364463218e-14, 4.28570755110786e-07, 1.42857163267871e-07, 0.499999214286561, 0.499999642857377, 2.85714000005597e-07,
        2.04081341115805e-14, 8.16325364463218e-14, 1.4285695918653e-07, 1.42857000002798e-07, 8.16325364463218e-14, 2.8571391837306e-07, 2.85714000005597e-07, 0.249999714286, 0.499999571428959, 0.24999985714298,
        2.04081341115805e-14, 8.16325364463218e-14, 7.14285408176674e-08, 2.14285418371661e-07, 8.16325364463218e-14, 1.42857081635335e-07, 4.28570836743322e-07, 2.14285438779795e-07, 0.499999500000541, 0.499999428571959,
        1.4285685714586e-07, 2.85713755107987e-07, 4.28570632661981e-07, 0.999997857145571, 8.16325364463218e-14, 2.44897609338966e-13, 2.85714000005597e-07, 1.83673207004224e-13, 4.28571000008395e-07, 5.71427673481048e-07,
        7.14284387769969e-08, 2.14285336739125e-07, 2.14285377555393e-07, 0.499999000001286, 1.42856918370262e-07, 2.14285500004198e-07, 0.499999142858286, 1.83673207004224e-13, 4.28571000008395e-07, 5.71427673481048e-07,
        7.14284387769969e-08, 1.42856918370262e-07, 2.85713795924256e-07, 0.499999000001286, 8.16325364463218e-14, 1.42857081635335e-07, 2.85714000005597e-07, 2.14285438779795e-07, 0.499999285715286, 5.71427673481048e-07,
        7.14284387769969e-08, 1.42856918370262e-07, 2.14285377555393e-07, 0.499999071429704, 8.16325364463218e-14, 2.44897609338966e-13, 4.28570836743322e-07, 1.83673207004224e-13, 6.42856255114983e-07, 0.499999428571959,
        2.04081341115805e-14, 1.42856918370262e-07, 1.22448804669483e-13, 1.42857000002798e-07, 2.85713755107987e-07, 4.28570755110786e-07, 0.999998000002571, 1.83673207004224e-13, 4.28571000008395e-07, 5.71427673481048e-07,
        2.04081341115805e-14, 7.14285000013992e-08, 7.14285408176674e-08, 1.42857000002798e-07, 1.42856918370262e-07, 3.57142336741923e-07, 0.499999142858286, 2.14285438779795e-07, 0.499999285715286, 5.71427673481048e-07,
        2.04081341115805e-14, 7.14285000013992e-08, 1.22448804669483e-13, 2.14285418371661e-07, 1.42856918370262e-07, 2.14285500004198e-07, 0.499999285715122, 1.83673207004224e-13, 6.42856255114983e-07, 0.499999428571959,
        2.04081341115805e-14, 8.16325364463218e-14, 1.4285695918653e-07, 1.42857000002798e-07, 8.16325364463218e-14, 2.8571391837306e-07, 2.85714000005597e-07, 4.28570693886384e-07, 0.999998142859571, 5.71427673481048e-07,
        2.04081341115805e-14, 8.16325364463218e-14, 7.14285408176674e-08, 2.14285418371661e-07, 8.16325364463218e-14, 1.42857081635335e-07, 4.28570836743322e-07, 2.14285438779795e-07, 0.499999500000541, 0.499999428571959,
        2.04081341115805e-14, 8.16325364463218e-14, 1.22448804669483e-13, 2.85713836740524e-07, 8.16325364463218e-14, 2.44897609338966e-13, 5.71427673481048e-07, 1.83673207004224e-13, 8.57141510221572e-07, 0.999998285716245;

    TransitionMatrix expected_matrix_zero = TransitionMatrix::Zero(100, 10);
    expected_matrix_zero
        << 0.999997428574918, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0.499998714287459, 0.499998785715888, 0, 0, 0, 0, 0, 0, 0, 0,
        0.499998714287459, 0, 0.499998857144316, 0, 0, 0, 0, 0, 0, 0,
        0.499998714287459, 0, 0, 0.499998928572745, 0, 0, 0, 0, 0, 0,
        0, 0.999997571431775, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0.499998785715888, 0.499998857144316, 0, 0, 0, 0, 0, 0, 0,
        0, 0.499998785715888, 0, 0.499998928572745, 0, 0, 0, 0, 0, 0,
        0, 0, 0.999997714288633, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0.499998857144316, 0.499998928572745, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0.99999785714549, 0, 0, 0, 0, 0, 0,
        0.499998714287459, 0.499998785715888, 0, 0, 0, 0, 0, 0, 0, 0,
        0.24999935714373, 0.499998785715888, 0, 0, 0.249999428572163, 0, 0, 0, 0, 0,
        0.24999935714373, 0.249999392857944, 0.249999428572158, 0, 0, 0.249999464286383, 0, 0, 0, 0,
        0.24999935714373, 0.249999392857944, 0, 0.249999464286372, 0, 0, 0.249999500000602, 0, 0, 0,
        0, 0.499998785715888, 0, 0, 0.499998857144326, 0, 0, 0, 0, 0,
        0, 0.249999392857944, 0.249999428572158, 0, 0.249999428572163, 0.249999464286383, 0, 0, 0, 0,
        0, 0.249999392857944, 0, 0.249999464286372, 0.249999428572163, 0, 0.249999500000602, 0, 0, 0,
        0, 0, 0.499998857144316, 0, 0, 0.499998928572765, 0, 0, 0, 0,
        0, 0, 0.249999428572158, 0.249999464286372, 0, 0.249999464286383, 0.249999500000602, 0, 0, 0,
        0, 0, 0, 0.499998928572745, 0, 0, 0.499999000001204, 0, 0, 0,
        0.499998714287459, 0, 0.499998857144316, 0, 0, 0, 0, 0, 0, 0,
        0.24999935714373, 0.249999392857944, 0.249999428572158, 0, 0, 0.249999464286383, 0, 0, 0, 0,
        0.24999935714373, 0, 0.499998857144316, 0, 0, 0, 0, 0.249999500000607, 0, 0,
        0.24999935714373, 0, 0.249999428572158, 0.249999464286372, 0, 0, 0, 0, 0.249999535714832, 0,
        0, 0.499998785715888, 0, 0, 0, 0.499998928572765, 0, 0, 0, 0,
        0, 0.249999392857944, 0.249999428572158, 0, 0, 0.249999464286383, 0, 0.249999500000607, 0, 0,
        0, 0.249999392857944, 0, 0.249999464286372, 0, 0.249999464286383, 0, 0, 0.249999535714832, 0,
        0, 0, 0.499998857144316, 0, 0, 0, 0, 0.499999000001214, 0, 0,
        0, 0, 0.249999428572158, 0.249999464286372, 0, 0, 0, 0.249999500000607, 0.249999535714832, 0,
        0, 0, 0, 0.499998928572745, 0, 0, 0, 0, 0.499999071429663, 0,
        0.499998714287459, 0, 0, 0.499998928572745, 0, 0, 0, 0, 0, 0,
        0.24999935714373, 0.249999392857944, 0, 0.249999464286372, 0, 0, 0.249999500000602, 0, 0, 0,
        0.24999935714373, 0, 0.249999428572158, 0.249999464286372, 0, 0, 0, 0, 0.249999535714832, 0,
        0.24999935714373, 0, 0, 0.499998928572745, 0, 0, 0, 0, 0, 0.249999571429061,
        0, 0.499998785715888, 0, 0, 0, 0, 0.499999000001204, 0, 0, 0,
        0, 0.249999392857944, 0.249999428572158, 0, 0, 0, 0.249999500000602, 0, 0.249999535714832, 0,
        0, 0.249999392857944, 0, 0.249999464286372, 0, 0, 0.249999500000602, 0, 0, 0.249999571429061,
        0, 0, 0.499998857144316, 0, 0, 0, 0, 0, 0.499999071429663, 0,
        0, 0, 0.249999428572158, 0.249999464286372, 0, 0, 0, 0, 0.249999535714832, 0.249999571429061,
        0, 0, 0, 0.499998928572745, 0, 0, 0, 0, 0, 0.499999142858122,
        0, 0.999997571431775, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0.499998785715888, 0, 0, 0.499998857144326, 0, 0, 0, 0, 0,
        0, 0.499998785715888, 0, 0, 0, 0.499998928572765, 0, 0, 0, 0,
        0, 0.499998785715888, 0, 0, 0, 0, 0.499999000001204, 0, 0, 0,
        0, 0, 0, 0, 0.999997714288653, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0.499998857144326, 0.499998928572765, 0, 0, 0, 0,
        0, 0, 0, 0, 0.499998857144326, 0, 0.499999000001204, 0, 0, 0,
        0, 0, 0, 0, 0, 0.999997857145531, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0.499998928572765, 0.499999000001204, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0.999998000002408, 0, 0, 0,
        0, 0.499998785715888, 0.499998857144316, 0, 0, 0, 0, 0, 0, 0,
        0, 0.249999392857944, 0.249999428572158, 0, 0.249999428572163, 0.249999464286383, 0, 0, 0, 0,
        0, 0.249999392857944, 0.249999428572158, 0, 0, 0.249999464286383, 0, 0.249999500000607, 0, 0,
        0, 0.249999392857944, 0.249999428572158, 0, 0, 0, 0.249999500000602, 0, 0.249999535714832, 0,
        0, 0, 0, 0, 0.499998857144326, 0.499998928572765, 0, 0, 0, 0,
        0, 0, 0, 0, 0.249999428572163, 0.499998928572765, 0, 0.249999500000607, 0, 0,
        0, 0, 0, 0, 0.249999428572163, 0.249999464286383, 0.249999500000602, 0, 0.249999535714832, 0,
        0, 0, 0, 0, 0, 0.499998928572765, 0, 0.499999000001214, 0, 0,
        0, 0, 0, 0, 0, 0.249999464286383, 0.249999500000602, 0.249999500000607, 0.249999535714832, 0,
        0, 0, 0, 0, 0, 0, 0.499999000001204, 0, 0.499999071429663, 0,
        0, 0.499998785715888, 0, 0.499998928572745, 0, 0, 0, 0, 0, 0,
        0, 0.249999392857944, 0, 0.249999464286372, 0.249999428572163, 0, 0.249999500000602, 0, 0, 0,
        0, 0.249999392857944, 0, 0.249999464286372, 0, 0.249999464286383, 0, 0, 0.249999535714832, 0,
        0, 0.249999392857944, 0, 0.249999464286372, 0, 0, 0.249999500000602, 0, 0, 0.249999571429061,
        0, 0, 0, 0, 0.499998857144326, 0, 0.499999000001204, 0, 0, 0,
        0, 0, 0, 0, 0.249999428572163, 0.249999464286383, 0.249999500000602, 0, 0.249999535714832, 0,
        0, 0, 0, 0, 0.249999428572163, 0, 0.499999000001204, 0, 0, 0.249999571429061,
        0, 0, 0, 0, 0, 0.499998928572765, 0, 0, 0.499999071429663, 0,
        0, 0, 0, 0, 0, 0.249999464286383, 0.249999500000602, 0, 0.249999535714832, 0.249999571429061,
        0, 0, 0, 0, 0, 0, 0.499999000001204, 0, 0, 0.499999142858122,
        0, 0, 0.999997714288633, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0.499998857144316, 0, 0, 0.499998928572765, 0, 0, 0, 0,
        0, 0, 0.499998857144316, 0, 0, 0, 0, 0.499999000001214, 0, 0,
        0, 0, 0.499998857144316, 0, 0, 0, 0, 0, 0.499999071429663, 0,
        0, 0, 0, 0, 0, 0.999997857145531, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0.499998928572765, 0, 0.499999000001214, 0, 0,
        0, 0, 0, 0, 0, 0.499998928572765, 0, 0, 0.499999071429663, 0,
        0, 0, 0, 0, 0, 0, 0, 0.999998000002429, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0.499999000001214, 0.499999071429663, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0.999998142859326, 0,
        0, 0, 0.499998857144316, 0.499998928572745, 0, 0, 0, 0, 0, 0,
        0, 0, 0.249999428572158, 0.249999464286372, 0, 0.249999464286383, 0.249999500000602, 0, 0, 0,
        0, 0, 0.249999428572158, 0.249999464286372, 0, 0, 0, 0.249999500000607, 0.249999535714832, 0,
        0, 0, 0.249999428572158, 0.249999464286372, 0, 0, 0, 0, 0.249999535714832, 0.249999571429061,
        0, 0, 0, 0, 0, 0.499998928572765, 0.499999000001204, 0, 0, 0,
        0, 0, 0, 0, 0, 0.249999464286383, 0.249999500000602, 0.249999500000607, 0.249999535714832, 0,
        0, 0, 0, 0, 0, 0.249999464286383, 0.249999500000602, 0, 0.249999535714832, 0.249999571429061,
        0, 0, 0, 0, 0, 0, 0, 0.499999000001214, 0.499999071429663, 0,
        0, 0, 0, 0, 0, 0, 0, 0.249999500000607, 0.499999071429663, 0.249999571429061,
        0, 0, 0, 0, 0, 0, 0, 0, 0.499999071429663, 0.499999142858122,
        0, 0, 0, 0.99999785714549, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0.499998928572745, 0, 0, 0.499999000001204, 0, 0, 0,
        0, 0, 0, 0.499998928572745, 0, 0, 0, 0, 0.499999071429663, 0,
        0, 0, 0, 0.499998928572745, 0, 0, 0, 0, 0, 0.499999142858122,
        0, 0, 0, 0, 0, 0, 0.999998000002408, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0.499999000001204, 0, 0.499999071429663, 0,
        0, 0, 0, 0, 0, 0, 0.499999000001204, 0, 0, 0.499999142858122,
        0, 0, 0, 0, 0, 0, 0, 0, 0.999998142859326, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0.499999071429663, 0.499999142858122,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0.999998285716245;

    TransitionMatrix expected_matrix_one = TransitionMatrix::Zero(100, 10);
    expected_matrix_one
        << 0, 5.71427428583438e-07, 8.57141142875158e-07, 1.14285485716688e-06, 0, 0, 0, 0, 0, 0,
        7.14284285729298e-08, 2.85713714291719e-07, 6.42855857156368e-07, 8.57141142875158e-07, 1.42856877553994e-07, 2.14285316330991e-07, 2.85713755107987e-07, 0, 0, 0,
        7.14284285729298e-08, 4.28570571437579e-07, 4.28570571437579e-07, 8.57141142875158e-07, 0, 1.42856897962128e-07, 0, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        7.14284285729298e-08, 4.28570571437579e-07, 6.42855857156368e-07, 5.71427428583438e-07, 0, 0, 1.42856918370262e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        1.4285685714586e-07, 0, 4.28570571437579e-07, 5.71427428583438e-07, 2.85713755107987e-07, 4.28570632661981e-07, 5.71427510215975e-07, 0, 0, 0,
        1.4285685714586e-07, 1.4285685714586e-07, 2.14285285718789e-07, 5.71427428583438e-07, 1.42856877553994e-07, 3.57142214293118e-07, 2.85713755107987e-07, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        1.4285685714586e-07, 1.4285685714586e-07, 4.28570571437579e-07, 2.85713714291719e-07, 1.42856877553994e-07, 2.14285316330991e-07, 4.28570673478249e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        1.4285685714586e-07, 2.85713714291719e-07, 0, 5.71427428583438e-07, 0, 2.85713795924256e-07, 0, 4.28570693886384e-07, 5.71427591848511e-07, 0,
        1.4285685714586e-07, 2.85713714291719e-07, 2.14285285718789e-07, 2.85713714291719e-07, 0, 1.42856897962128e-07, 1.42856918370262e-07, 2.14285346943192e-07, 4.99999173479649e-07, 2.85713836740524e-07,
        1.4285685714586e-07, 2.85713714291719e-07, 4.28570571437579e-07, 0, 0, 0, 2.85713836740524e-07, 0, 4.28570755110786e-07, 5.71427673481048e-07,
        7.14284285729298e-08, 2.85713714291719e-07, 6.42855857156368e-07, 8.57141142875158e-07, 1.42856877553994e-07, 2.14285316330991e-07, 2.85713755107987e-07, 0, 0, 0,
        7.14284285729298e-08, 2.14285295922856e-07, 4.28570571437579e-07, 5.71427428583438e-07, 1.42856877553994e-07, 4.28570632661981e-07, 5.71427510215975e-07, 0, 0, 0,
        7.14284285729298e-08, 2.49999505107288e-07, 3.57142153068716e-07, 5.71427428583438e-07, 1.42856877553994e-07, 1.78571107146559e-07, 2.85713755107987e-07, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        7.14284285729298e-08, 2.49999505107288e-07, 4.28570571437579e-07, 4.64284801030144e-07, 1.42856877553994e-07, 2.14285316330991e-07, 2.14285336739125e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.42856877553994e-07, 2.14285285718789e-07, 2.85713714291719e-07, 1.42856877553994e-07, 6.42855948992972e-07, 8.57141265323962e-07, 0, 0, 0,
        7.14284285729298e-08, 1.78571086738425e-07, 1.42856867349927e-07, 2.85713714291719e-07, 1.42856877553994e-07, 3.9285642347755e-07, 5.71427510215975e-07, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        7.14284285729298e-08, 1.78571086738425e-07, 2.14285285718789e-07, 1.78571086738425e-07, 1.42856877553994e-07, 4.28570632661981e-07, 4.99999091847112e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 2.14285295922856e-07, 7.14284489810639e-08, 2.85713714291719e-07, 1.42856877553994e-07, 1.42856897962128e-07, 2.85713755107987e-07, 4.28570693886384e-07, 5.71427591848511e-07, 0,
        7.14284285729298e-08, 2.14285295922856e-07, 1.42856867349927e-07, 1.78571086738425e-07, 1.42856877553994e-07, 1.78571107146559e-07, 2.14285336739125e-07, 2.14285346943192e-07, 4.99999173479649e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 2.14285295922856e-07, 2.14285285718789e-07, 7.1428459185131e-08, 1.42856877553994e-07, 2.14285316330991e-07, 1.42856918370262e-07, 0, 4.28570755110786e-07, 5.71427673481048e-07,
        7.14284285729298e-08, 4.28570571437579e-07, 4.28570571437579e-07, 8.57141142875158e-07, 0, 1.42856897962128e-07, 0, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        7.14284285729298e-08, 2.49999505107288e-07, 3.57142153068716e-07, 5.71427428583438e-07, 1.42856877553994e-07, 1.78571107146559e-07, 2.85713755107987e-07, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        7.14284285729298e-08, 2.85713714291719e-07, 2.85713734699853e-07, 5.71427428583438e-07, 0, 2.85713795924256e-07, 0, 2.14285346943192e-07, 5.71427591848511e-07, 0,
        7.14284285729298e-08, 2.85713714291719e-07, 3.57142153068716e-07, 4.64284801030144e-07, 0, 1.42856897962128e-07, 1.42856918370262e-07, 2.14285346943192e-07, 2.49999586739824e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 7.14284387769968e-08, 2.85713734699853e-07, 2.85713714291719e-07, 2.85713755107987e-07, 2.14285316330991e-07, 5.71427510215975e-07, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        7.14284285729298e-08, 1.07142647961428e-07, 2.14285316330991e-07, 2.85713714291719e-07, 1.42856877553994e-07, 3.21428005108687e-07, 2.85713755107987e-07, 2.14285346943192e-07, 5.71427591848511e-07, 0,
        7.14284285729298e-08, 1.07142647961428e-07, 2.85713734699853e-07, 1.78571086738425e-07, 1.42856877553994e-07, 1.78571107146559e-07, 4.28570673478249e-07, 2.14285346943192e-07, 2.49999586739824e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.4285685714586e-07, 1.42856897962128e-07, 2.85713714291719e-07, 0, 4.28570693886383e-07, 0, 2.14285346943192e-07, 8.57141387772767e-07, 0,
        7.14284285729298e-08, 1.4285685714586e-07, 2.14285316330991e-07, 1.78571086738425e-07, 0, 2.85713795924256e-07, 1.42856918370262e-07, 2.14285346943192e-07, 5.3571338266408e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.4285685714586e-07, 2.85713734699853e-07, 7.1428459185131e-08, 0, 1.42856897962128e-07, 2.85713836740524e-07, 2.14285346943192e-07, 2.14285377555393e-07, 5.71427673481048e-07,
        7.14284285729298e-08, 4.28570571437579e-07, 6.42855857156368e-07, 5.71427428583438e-07, 0, 0, 1.42856918370262e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 2.49999505107288e-07, 4.28570571437579e-07, 4.64284801030144e-07, 1.42856877553994e-07, 2.14285316330991e-07, 2.14285336739125e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 2.85713714291719e-07, 3.57142153068716e-07, 4.64284801030144e-07, 0, 1.42856897962128e-07, 1.42856918370262e-07, 2.14285346943192e-07, 2.49999586739824e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 2.85713714291719e-07, 4.28570571437579e-07, 3.5714217347685e-07, 0, 0, 2.85713836740524e-07, 0, 4.28570755110786e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 7.14284387769968e-08, 2.14285285718789e-07, 3.5714217347685e-07, 2.85713755107987e-07, 4.28570632661981e-07, 2.85713755107987e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.07142647961428e-07, 1.42856867349927e-07, 3.5714217347685e-07, 1.42856877553994e-07, 3.57142214293118e-07, 2.14285336739125e-07, 2.14285346943192e-07, 2.49999586739824e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.07142647961428e-07, 2.14285285718789e-07, 2.49999545923556e-07, 1.42856877553994e-07, 2.14285316330991e-07, 3.57142255109387e-07, 0, 4.28570755110786e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.4285685714586e-07, 7.14284489810639e-08, 3.5714217347685e-07, 0, 2.85713795924256e-07, 1.42856918370262e-07, 4.28570693886384e-07, 2.85713795924256e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.4285685714586e-07, 1.42856867349927e-07, 2.49999545923556e-07, 0, 1.42856897962128e-07, 2.85713836740524e-07, 2.14285346943192e-07, 4.64284964295217e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.4285685714586e-07, 2.14285285718789e-07, 1.42856918370262e-07, 0, 0, 4.28570755110786e-07, 0, 6.42856132666179e-07, 2.85713836740524e-07,
        1.4285685714586e-07, 0, 4.28570571437579e-07, 5.71427428583438e-07, 2.85713755107987e-07, 4.28570632661981e-07, 5.71427510215975e-07, 0, 0, 0,
        7.14284285729298e-08, 1.42856877553994e-07, 2.14285285718789e-07, 2.85713714291719e-07, 1.42856877553994e-07, 6.42855948992972e-07, 8.57141265323962e-07, 0, 0, 0,
        7.14284285729298e-08, 7.14284387769968e-08, 2.85713734699853e-07, 2.85713714291719e-07, 2.85713755107987e-07, 2.14285316330991e-07, 5.71427510215975e-07, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        7.14284285729298e-08, 7.14284387769968e-08, 2.14285285718789e-07, 3.5714217347685e-07, 2.85713755107987e-07, 4.28570632661981e-07, 2.85713755107987e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        0, 2.85713755107987e-07, 0, 0, 0, 8.57141265323962e-07, 1.14285502043195e-06, 0, 0, 0,
        0, 2.14285316330991e-07, 7.14284489810639e-08, 0, 1.42856877553994e-07, 4.28570632661981e-07, 8.57141265323962e-07, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        0, 2.14285316330991e-07, 0, 7.1428459185131e-08, 1.42856877553994e-07, 6.42855948992972e-07, 5.71427510215975e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        0, 1.42856877553994e-07, 1.42856897962128e-07, 0, 2.85713755107987e-07, 0, 5.71427510215975e-07, 4.28570693886384e-07, 5.71427591848511e-07, 0,
        0, 1.42856877553994e-07, 7.14284489810639e-08, 7.1428459185131e-08, 2.85713755107987e-07, 2.14285316330991e-07, 2.85713755107987e-07, 2.14285346943192e-07, 4.99999173479649e-07, 2.85713836740524e-07,
        0, 1.42856877553994e-07, 0, 1.42856918370262e-07, 2.85713755107987e-07, 4.28570632661981e-07, 0, 0, 4.28570755110786e-07, 5.71427673481048e-07,
        1.4285685714586e-07, 1.4285685714586e-07, 2.14285285718789e-07, 5.71427428583438e-07, 1.42856877553994e-07, 3.57142214293118e-07, 2.85713755107987e-07, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        7.14284285729298e-08, 1.78571086738425e-07, 1.42856867349927e-07, 2.85713714291719e-07, 1.42856877553994e-07, 3.9285642347755e-07, 5.71427510215975e-07, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        7.14284285729298e-08, 1.07142647961428e-07, 2.14285316330991e-07, 2.85713714291719e-07, 1.42856877553994e-07, 3.21428005108687e-07, 2.85713755107987e-07, 2.14285346943192e-07, 5.71427591848511e-07, 0,
        7.14284285729298e-08, 1.07142647961428e-07, 1.42856867349927e-07, 3.5714217347685e-07, 1.42856877553994e-07, 3.57142214293118e-07, 2.14285336739125e-07, 2.14285346943192e-07, 2.49999586739824e-07, 2.85713836740524e-07,
        0, 2.14285316330991e-07, 7.14284489810639e-08, 0, 1.42856877553994e-07, 4.28570632661981e-07, 8.57141265323962e-07, 2.14285346943192e-07, 2.85713795924256e-07, 0,
        0, 1.42856877553994e-07, 1.42856897962128e-07, 0, 1.42856877553994e-07, 3.57142214293118e-07, 5.71427510215975e-07, 2.14285346943192e-07, 5.71427591848511e-07, 0,
        0, 1.42856877553994e-07, 7.14284489810639e-08, 7.1428459185131e-08, 1.42856877553994e-07, 3.9285642347755e-07, 4.99999091847112e-07, 2.14285346943192e-07, 2.49999586739824e-07, 2.85713836740524e-07,
        0, 7.14284387769968e-08, 2.14285346943192e-07, 0, 1.42856877553994e-07, 2.85713795924256e-07, 2.85713755107987e-07, 2.14285346943192e-07, 8.57141387772767e-07, 0,
        0, 7.14284387769968e-08, 1.42856897962128e-07, 7.1428459185131e-08, 1.42856877553994e-07, 3.21428005108687e-07, 2.14285336739125e-07, 2.14285346943192e-07, 5.3571338266408e-07, 2.85713836740524e-07,
        0, 7.14284387769968e-08, 7.14284489810639e-08, 1.42856918370262e-07, 1.42856877553994e-07, 3.57142214293118e-07, 1.42856918370262e-07, 2.14285346943192e-07, 2.14285377555393e-07, 5.71427673481048e-07,
        1.4285685714586e-07, 1.4285685714586e-07, 4.28570571437579e-07, 2.85713714291719e-07, 1.42856877553994e-07, 2.14285316330991e-07, 4.28570673478249e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.78571086738425e-07, 2.14285285718789e-07, 1.78571086738425e-07, 1.42856877553994e-07, 4.28570632661981e-07, 4.99999091847112e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.07142647961428e-07, 2.85713734699853e-07, 1.78571086738425e-07, 1.42856877553994e-07, 1.78571107146559e-07, 4.28570673478249e-07, 2.14285346943192e-07, 2.49999586739824e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.07142647961428e-07, 2.14285285718789e-07, 2.49999545923556e-07, 1.42856877553994e-07, 2.14285316330991e-07, 3.57142255109387e-07, 0, 4.28570755110786e-07, 2.85713836740524e-07,
        0, 2.14285316330991e-07, 0, 7.1428459185131e-08, 1.42856877553994e-07, 6.42855948992972e-07, 5.71427510215975e-07, 0, 2.14285377555393e-07, 2.85713836740524e-07,
        0, 1.42856877553994e-07, 7.14284489810639e-08, 7.1428459185131e-08, 1.42856877553994e-07, 3.9285642347755e-07, 4.99999091847112e-07, 2.14285346943192e-07, 2.49999586739824e-07, 2.85713836740524e-07,
        0, 1.42856877553994e-07, 0, 1.42856918370262e-07, 1.42856877553994e-07, 4.28570632661981e-07, 4.28570673478249e-07, 0, 4.28570755110786e-07, 2.85713836740524e-07,
        0, 7.14284387769968e-08, 1.42856897962128e-07, 7.1428459185131e-08, 1.42856877553994e-07, 1.42856897962128e-07, 4.28570673478249e-07, 4.28570693886384e-07, 2.85713795924256e-07, 2.85713836740524e-07,
        0, 7.14284387769968e-08, 7.14284489810639e-08, 1.42856918370262e-07, 1.42856877553994e-07, 1.78571107146559e-07, 3.57142255109387e-07, 2.14285346943192e-07, 4.64284964295217e-07, 2.85713836740524e-07,
        0, 7.14284387769968e-08, 0, 2.14285377555393e-07, 1.42856877553994e-07, 2.14285316330991e-07, 2.85713836740524e-07, 0, 6.42856132666179e-07, 2.85713836740524e-07,
        1.4285685714586e-07, 2.85713714291719e-07, 0, 5.71427428583438e-07, 0, 2.85713795924256e-07, 0, 4.28570693886384e-07, 5.71427591848511e-07, 0,
        7.14284285729298e-08, 2.14285295922856e-07, 7.14284489810639e-08, 2.85713714291719e-07, 1.42856877553994e-07, 1.42856897962128e-07, 2.85713755107987e-07, 4.28570693886384e-07, 5.71427591848511e-07, 0,
        7.14284285729298e-08, 1.4285685714586e-07, 1.42856897962128e-07, 2.85713714291719e-07, 0, 4.28570693886383e-07, 0, 2.14285346943192e-07, 8.57141387772767e-07, 0,
        7.14284285729298e-08, 1.4285685714586e-07, 7.14284489810639e-08, 3.5714217347685e-07, 0, 2.85713795924256e-07, 1.42856918370262e-07, 4.28570693886384e-07, 2.85713795924256e-07, 2.85713836740524e-07,
        0, 1.42856877553994e-07, 1.42856897962128e-07, 0, 2.85713755107987e-07, 0, 5.71427510215975e-07, 4.28570693886384e-07, 5.71427591848511e-07, 0,
        0, 7.14284387769968e-08, 2.14285346943192e-07, 0, 1.42856877553994e-07, 2.85713795924256e-07, 2.85713755107987e-07, 2.14285346943192e-07, 8.57141387772767e-07, 0,
        0, 7.14284387769968e-08, 1.42856897962128e-07, 7.1428459185131e-08, 1.42856877553994e-07, 1.42856897962128e-07, 4.28570673478249e-07, 4.28570693886384e-07, 2.85713795924256e-07, 2.85713836740524e-07,
        0, 0, 2.85713795924256e-07, 0, 0, 5.71427591848511e-07, 0, 0, 1.14285518369702e-06, 0,
        0, 0, 2.14285346943192e-07, 7.1428459185131e-08, 0, 4.28570693886383e-07, 1.42856918370262e-07, 2.14285346943192e-07, 5.71427591848511e-07, 2.85713836740524e-07,
        0, 0, 1.42856897962128e-07, 1.42856918370262e-07, 0, 2.85713795924256e-07, 2.85713836740524e-07, 4.28570693886384e-07, 0, 5.71427673481048e-07,
        1.4285685714586e-07, 2.85713714291719e-07, 2.14285285718789e-07, 2.85713714291719e-07, 0, 1.42856897962128e-07, 1.42856918370262e-07, 2.14285346943192e-07, 4.99999173479649e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 2.14285295922856e-07, 1.42856867349927e-07, 1.78571086738425e-07, 1.42856877553994e-07, 1.78571107146559e-07, 2.14285336739125e-07, 2.14285346943192e-07, 4.99999173479649e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.4285685714586e-07, 2.14285316330991e-07, 1.78571086738425e-07, 0, 2.85713795924256e-07, 1.42856918370262e-07, 2.14285346943192e-07, 5.3571338266408e-07, 2.85713836740524e-07,
        7.14284285729298e-08, 1.4285685714586e-07, 1.42856867349927e-07, 2.49999545923556e-07, 0, 1.42856897962128e-07, 2.85713836740524e-07, 2.14285346943192e-07, 4.64284964295217e-07, 2.85713836740524e-07,
        0, 1.42856877553994e-07, 7.14284489810639e-08, 7.1428459185131e-08, 2.85713755107987e-07, 2.14285316330991e-07, 2.85713755107987e-07, 2.14285346943192e-07, 4.99999173479649e-07, 2.85713836740524e-07,
        0, 7.14284387769968e-08, 1.42856897962128e-07, 7.1428459185131e-08, 1.42856877553994e-07, 3.21428005108687e-07, 2.14285336739125e-07, 2.14285346943192e-07, 5.3571338266408e-07, 2.85713836740524e-07,
        0, 7.14284387769968e-08, 7.14284489810639e-08, 1.42856918370262e-07, 1.42856877553994e-07, 1.78571107146559e-07, 3.57142255109387e-07, 2.14285346943192e-07, 4.64284964295217e-07, 2.85713836740524e-07,
        0, 0, 2.14285346943192e-07, 7.1428459185131e-08, 0, 4.28570693886383e-07, 1.42856918370262e-07, 2.14285346943192e-07, 5.71427591848511e-07, 2.85713836740524e-07,
        0, 0, 1.42856897962128e-07, 1.42856918370262e-07, 0, 2.85713795924256e-07, 2.85713836740524e-07, 2.14285346943192e-07, 4.99999173479649e-07, 2.85713836740524e-07,
        0, 0, 7.14284489810639e-08, 2.14285377555393e-07, 0, 1.42856897962128e-07, 4.28570755110786e-07, 2.14285346943192e-07, 4.28570755110786e-07, 2.85713836740524e-07,
        1.4285685714586e-07, 2.85713714291719e-07, 4.28570571437579e-07, 0, 0, 0, 2.85713836740524e-07, 0, 4.28570755110786e-07, 5.71427673481048e-07,
        7.14284285729298e-08, 2.14285295922856e-07, 2.14285285718789e-07, 7.1428459185131e-08, 1.42856877553994e-07, 2.14285316330991e-07, 1.42856918370262e-07, 0, 4.28570755110786e-07, 5.71427673481048e-07,
        7.14284285729298e-08, 1.4285685714586e-07, 2.85713734699853e-07, 7.1428459185131e-08, 0, 1.42856897962128e-07, 2.85713836740524e-07, 2.14285346943192e-07, 2.14285377555393e-07, 5.71427673481048e-07,
        7.14284285729298e-08, 1.4285685714586e-07, 2.14285285718789e-07, 1.42856918370262e-07, 0, 0, 4.28570755110786e-07, 0, 6.42856132666179e-07, 2.85713836740524e-07,
        0, 1.42856877553994e-07, 0, 1.42856918370262e-07, 2.85713755107987e-07, 4.28570632661981e-07, 0, 0, 4.28570755110786e-07, 5.71427673481048e-07,
        0, 7.14284387769968e-08, 7.14284489810639e-08, 1.42856918370262e-07, 1.42856877553994e-07, 3.57142214293118e-07, 1.42856918370262e-07, 2.14285346943192e-07, 2.14285377555393e-07, 5.71427673481048e-07,
        0, 7.14284387769968e-08, 0, 2.14285377555393e-07, 1.42856877553994e-07, 2.14285316330991e-07, 2.85713836740524e-07, 0, 6.42856132666179e-07, 2.85713836740524e-07,
        0, 0, 1.42856897962128e-07, 1.42856918370262e-07, 0, 2.85713795924256e-07, 2.85713836740524e-07, 4.28570693886384e-07, 0, 5.71427673481048e-07,
        0, 0, 7.14284489810639e-08, 2.14285377555393e-07, 0, 1.42856897962128e-07, 4.28570755110786e-07, 2.14285346943192e-07, 4.28570755110786e-07, 2.85713836740524e-07,
        0, 0, 0, 2.85713836740524e-07, 0, 0, 5.71427673481048e-07, 0, 8.57141510221572e-07, 0;

    TransitionMatrix expected_matrix_two = TransitionMatrix::Zero(100, 10);
    expected_matrix_two
        << 0, 0, 0, 0, 8.16325364463218e-14, 2.44897609338966e-13, 3.26530145785287e-13, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        0, 2.04081341115805e-14, 3.06122011673707e-14, 4.08162682231609e-14, 4.08162682231609e-14, 1.83673207004224e-13, 2.44897609338966e-13, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        0, 2.04081341115805e-14, 3.06122011673707e-14, 4.08162682231609e-14, 8.16325364463218e-14, 1.83673207004224e-13, 3.26530145785287e-13, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        0, 2.04081341115805e-14, 3.06122011673707e-14, 4.08162682231609e-14, 8.16325364463218e-14, 2.44897609338966e-13, 2.44897609338966e-13, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 0, 1.22448804669483e-13, 1.63265072892644e-13, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.22448804669483e-13, 2.44897609338966e-13, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.83673207004224e-13, 1.63265072892644e-13, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.22448804669483e-13, 3.26530145785287e-13, 0, 2.44897609338966e-13, 3.26530145785287e-13,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.83673207004224e-13, 2.44897609338966e-13, 9.18366035021121e-14, 2.44897609338966e-13, 1.63265072892644e-13,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 2.44897609338966e-13, 1.63265072892644e-13, 1.83673207004224e-13, 2.44897609338966e-13, 0,
        0, 2.04081341115805e-14, 3.06122011673707e-14, 4.08162682231609e-14, 4.08162682231609e-14, 1.83673207004224e-13, 2.44897609338966e-13, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        5.10203352789511e-15, 2.04081341115805e-14, 6.12244023347414e-14, 8.16325364463218e-14, 2.04081341115805e-14, 1.22448804669483e-13, 1.63265072892644e-13, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        5.10203352789511e-15, 3.06122011673707e-14, 4.5918301751056e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.53061005836853e-13, 2.44897609338966e-13, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        5.10203352789511e-15, 3.06122011673707e-14, 6.12244023347414e-14, 6.12244023347414e-14, 4.08162682231609e-14, 1.83673207004224e-13, 2.04081341115805e-13, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 2.04081341115805e-14, 9.18366035021121e-14, 1.22448804669483e-13, 0, 6.12244023347414e-14, 8.16325364463218e-14, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 3.06122011673707e-14, 7.65305029184267e-14, 1.22448804669483e-13, 2.04081341115805e-14, 9.18366035021121e-14, 1.63265072892644e-13, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 3.06122011673707e-14, 9.18366035021121e-14, 1.02040670557902e-13, 2.04081341115805e-14, 1.22448804669483e-13, 1.22448804669483e-13, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 4.08162682231609e-14, 6.12244023347414e-14, 1.22448804669483e-13, 4.08162682231609e-14, 1.22448804669483e-13, 2.44897609338966e-13, 0, 2.44897609338966e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 4.08162682231609e-14, 7.65305029184267e-14, 1.02040670557902e-13, 4.08162682231609e-14, 1.53061005836853e-13, 2.04081341115805e-13, 9.18366035021121e-14, 2.44897609338966e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 4.08162682231609e-14, 9.18366035021121e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.83673207004224e-13, 1.63265072892644e-13, 1.83673207004224e-13, 2.44897609338966e-13, 0,
        0, 2.04081341115805e-14, 3.06122011673707e-14, 4.08162682231609e-14, 8.16325364463218e-14, 1.83673207004224e-13, 3.26530145785287e-13, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        5.10203352789511e-15, 3.06122011673707e-14, 4.5918301751056e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.53061005836853e-13, 2.44897609338966e-13, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        5.10203352789511e-15, 4.08162682231609e-14, 3.06122011673707e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.22448804669483e-13, 3.26530145785287e-13, 4.5918301751056e-14, 2.44897609338966e-13, 3.26530145785287e-13,
        5.10203352789511e-15, 4.08162682231609e-14, 4.5918301751056e-14, 6.12244023347414e-14, 8.16325364463218e-14, 1.83673207004224e-13, 2.44897609338966e-13, 9.18366035021121e-14, 3.06122011673707e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 4.08162682231609e-14, 6.12244023347414e-14, 1.22448804669483e-13, 0, 1.22448804669483e-13, 1.63265072892644e-13, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 5.10203352789511e-14, 4.5918301751056e-14, 1.22448804669483e-13, 4.08162682231609e-14, 9.18366035021121e-14, 2.44897609338966e-13, 4.5918301751056e-14, 2.44897609338966e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 5.10203352789511e-14, 6.12244023347414e-14, 1.02040670557902e-13, 4.08162682231609e-14, 1.53061005836853e-13, 1.63265072892644e-13, 9.18366035021121e-14, 3.06122011673707e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 6.12244023347414e-14, 3.06122011673707e-14, 1.22448804669483e-13, 8.16325364463218e-14, 6.12244023347414e-14, 3.26530145785287e-13, 0, 1.22448804669483e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 6.12244023347414e-14, 4.5918301751056e-14, 1.02040670557902e-13, 8.16325364463218e-14, 1.22448804669483e-13, 2.44897609338966e-13, 4.5918301751056e-14, 1.83673207004224e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 6.12244023347414e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.83673207004224e-13, 1.63265072892644e-13, 9.18366035021121e-14, 2.44897609338966e-13, 0,
        0, 2.04081341115805e-14, 3.06122011673707e-14, 4.08162682231609e-14, 8.16325364463218e-14, 2.44897609338966e-13, 2.44897609338966e-13, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        5.10203352789511e-15, 3.06122011673707e-14, 6.12244023347414e-14, 6.12244023347414e-14, 4.08162682231609e-14, 1.83673207004224e-13, 2.04081341115805e-13, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        5.10203352789511e-15, 4.08162682231609e-14, 4.5918301751056e-14, 6.12244023347414e-14, 8.16325364463218e-14, 1.83673207004224e-13, 2.44897609338966e-13, 9.18366035021121e-14, 3.06122011673707e-13, 1.63265072892644e-13,
        5.10203352789511e-15, 4.08162682231609e-14, 6.12244023347414e-14, 4.08162682231609e-14, 8.16325364463218e-14, 2.44897609338966e-13, 1.63265072892644e-13, 1.83673207004224e-13, 2.44897609338966e-13, 8.16325364463218e-14,
        1.02040670557902e-14, 4.08162682231609e-14, 9.18366035021121e-14, 8.16325364463218e-14, 0, 1.22448804669483e-13, 1.63265072892644e-13, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 5.10203352789511e-14, 7.65305029184267e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.22448804669483e-13, 2.04081341115805e-13, 9.18366035021121e-14, 3.06122011673707e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 5.10203352789511e-14, 9.18366035021121e-14, 6.12244023347414e-14, 4.08162682231609e-14, 1.83673207004224e-13, 1.22448804669483e-13, 1.83673207004224e-13, 2.44897609338966e-13, 8.16325364463218e-14,
        1.02040670557902e-14, 6.12244023347414e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.22448804669483e-13, 2.44897609338966e-13, 0, 2.44897609338966e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 6.12244023347414e-14, 7.65305029184267e-14, 6.12244023347414e-14, 8.16325364463218e-14, 1.83673207004224e-13, 1.63265072892644e-13, 9.18366035021121e-14, 1.83673207004224e-13, 8.16325364463218e-14,
        1.02040670557902e-14, 6.12244023347414e-14, 9.18366035021121e-14, 4.08162682231609e-14, 8.16325364463218e-14, 2.44897609338966e-13, 8.16325364463218e-14, 1.83673207004224e-13, 1.22448804669483e-13, 0,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 0, 1.22448804669483e-13, 1.63265072892644e-13, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 2.04081341115805e-14, 9.18366035021121e-14, 1.22448804669483e-13, 0, 6.12244023347414e-14, 8.16325364463218e-14, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 4.08162682231609e-14, 6.12244023347414e-14, 1.22448804669483e-13, 0, 1.22448804669483e-13, 1.63265072892644e-13, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 4.08162682231609e-14, 9.18366035021121e-14, 8.16325364463218e-14, 0, 1.22448804669483e-13, 1.63265072892644e-13, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 0, 1.22448804669483e-13, 1.63265072892644e-13, 0, 0, 0, 1.83673207004224e-13, 4.89795218677931e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 2.04081341115805e-14, 9.18366035021121e-14, 1.63265072892644e-13, 0, 6.12244023347414e-14, 8.16325364463218e-14, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 2.04081341115805e-14, 1.22448804669483e-13, 1.22448804669483e-13, 0, 6.12244023347414e-14, 8.16325364463218e-14, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 4.08162682231609e-14, 6.12244023347414e-14, 1.63265072892644e-13, 0, 1.22448804669483e-13, 1.63265072892644e-13, 0, 2.44897609338966e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 4.08162682231609e-14, 9.18366035021121e-14, 1.22448804669483e-13, 0, 1.22448804669483e-13, 1.63265072892644e-13, 9.18366035021121e-14, 2.44897609338966e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 4.08162682231609e-14, 1.22448804669483e-13, 8.16325364463218e-14, 0, 1.22448804669483e-13, 1.63265072892644e-13, 1.83673207004224e-13, 2.44897609338966e-13, 0,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.22448804669483e-13, 2.44897609338966e-13, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 3.06122011673707e-14, 7.65305029184267e-14, 1.22448804669483e-13, 2.04081341115805e-14, 9.18366035021121e-14, 1.63265072892644e-13, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 5.10203352789511e-14, 4.5918301751056e-14, 1.22448804669483e-13, 4.08162682231609e-14, 9.18366035021121e-14, 2.44897609338966e-13, 4.5918301751056e-14, 2.44897609338966e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 5.10203352789511e-14, 7.65305029184267e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.22448804669483e-13, 2.04081341115805e-13, 9.18366035021121e-14, 3.06122011673707e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 2.04081341115805e-14, 9.18366035021121e-14, 1.63265072892644e-13, 0, 6.12244023347414e-14, 8.16325364463218e-14, 9.18366035021121e-14, 3.67346414008448e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 4.08162682231609e-14, 6.12244023347414e-14, 1.63265072892644e-13, 2.04081341115805e-14, 6.12244023347414e-14, 1.63265072892644e-13, 4.5918301751056e-14, 2.44897609338966e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 4.08162682231609e-14, 9.18366035021121e-14, 1.22448804669483e-13, 2.04081341115805e-14, 9.18366035021121e-14, 1.22448804669483e-13, 9.18366035021121e-14, 3.06122011673707e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 6.12244023347414e-14, 3.06122011673707e-14, 1.63265072892644e-13, 4.08162682231609e-14, 6.12244023347414e-14, 2.44897609338966e-13, 0, 1.22448804669483e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 6.12244023347414e-14, 6.12244023347414e-14, 1.22448804669483e-13, 4.08162682231609e-14, 9.18366035021121e-14, 2.04081341115805e-13, 4.5918301751056e-14, 1.83673207004224e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 6.12244023347414e-14, 9.18366035021121e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.22448804669483e-13, 1.63265072892644e-13, 9.18366035021121e-14, 2.44897609338966e-13, 0,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.83673207004224e-13, 1.63265072892644e-13, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 3.06122011673707e-14, 9.18366035021121e-14, 1.02040670557902e-13, 2.04081341115805e-14, 1.22448804669483e-13, 1.22448804669483e-13, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 5.10203352789511e-14, 6.12244023347414e-14, 1.02040670557902e-13, 4.08162682231609e-14, 1.53061005836853e-13, 1.63265072892644e-13, 9.18366035021121e-14, 3.06122011673707e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 5.10203352789511e-14, 9.18366035021121e-14, 6.12244023347414e-14, 4.08162682231609e-14, 1.83673207004224e-13, 1.22448804669483e-13, 1.83673207004224e-13, 2.44897609338966e-13, 8.16325364463218e-14,
        2.04081341115805e-14, 2.04081341115805e-14, 1.22448804669483e-13, 1.22448804669483e-13, 0, 6.12244023347414e-14, 8.16325364463218e-14, 1.83673207004224e-13, 3.67346414008448e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 4.08162682231609e-14, 9.18366035021121e-14, 1.22448804669483e-13, 2.04081341115805e-14, 9.18366035021121e-14, 1.22448804669483e-13, 9.18366035021121e-14, 3.06122011673707e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 4.08162682231609e-14, 1.22448804669483e-13, 8.16325364463218e-14, 2.04081341115805e-14, 1.22448804669483e-13, 8.16325364463218e-14, 1.83673207004224e-13, 2.44897609338966e-13, 8.16325364463218e-14,
        2.04081341115805e-14, 6.12244023347414e-14, 6.12244023347414e-14, 1.22448804669483e-13, 4.08162682231609e-14, 1.22448804669483e-13, 1.63265072892644e-13, 0, 2.44897609338966e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 6.12244023347414e-14, 9.18366035021121e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.53061005836853e-13, 1.22448804669483e-13, 9.18366035021121e-14, 1.83673207004224e-13, 8.16325364463218e-14,
        2.04081341115805e-14, 6.12244023347414e-14, 1.22448804669483e-13, 4.08162682231609e-14, 4.08162682231609e-14, 1.83673207004224e-13, 8.16325364463218e-14, 1.83673207004224e-13, 1.22448804669483e-13, 0,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.22448804669483e-13, 3.26530145785287e-13, 0, 2.44897609338966e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 4.08162682231609e-14, 6.12244023347414e-14, 1.22448804669483e-13, 4.08162682231609e-14, 1.22448804669483e-13, 2.44897609338966e-13, 0, 2.44897609338966e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 6.12244023347414e-14, 3.06122011673707e-14, 1.22448804669483e-13, 8.16325364463218e-14, 6.12244023347414e-14, 3.26530145785287e-13, 0, 1.22448804669483e-13, 3.26530145785287e-13,
        1.02040670557902e-14, 6.12244023347414e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.22448804669483e-13, 2.44897609338966e-13, 0, 2.44897609338966e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 4.08162682231609e-14, 6.12244023347414e-14, 1.63265072892644e-13, 0, 1.22448804669483e-13, 1.63265072892644e-13, 0, 2.44897609338966e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 6.12244023347414e-14, 3.06122011673707e-14, 1.63265072892644e-13, 4.08162682231609e-14, 6.12244023347414e-14, 2.44897609338966e-13, 0, 1.22448804669483e-13, 3.26530145785287e-13,
        2.04081341115805e-14, 6.12244023347414e-14, 6.12244023347414e-14, 1.22448804669483e-13, 4.08162682231609e-14, 1.22448804669483e-13, 1.63265072892644e-13, 0, 2.44897609338966e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 8.16325364463218e-14, 0, 1.63265072892644e-13, 8.16325364463218e-14, 0, 3.26530145785287e-13, 0, 0, 3.26530145785287e-13,
        2.04081341115805e-14, 8.16325364463218e-14, 3.06122011673707e-14, 1.22448804669483e-13, 8.16325364463218e-14, 6.12244023347414e-14, 2.44897609338966e-13, 0, 1.22448804669483e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 8.16325364463218e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.22448804669483e-13, 1.63265072892644e-13, 0, 2.44897609338966e-13, 0,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.83673207004224e-13, 2.44897609338966e-13, 9.18366035021121e-14, 2.44897609338966e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 4.08162682231609e-14, 7.65305029184267e-14, 1.02040670557902e-13, 4.08162682231609e-14, 1.53061005836853e-13, 2.04081341115805e-13, 9.18366035021121e-14, 2.44897609338966e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 6.12244023347414e-14, 4.5918301751056e-14, 1.02040670557902e-13, 8.16325364463218e-14, 1.22448804669483e-13, 2.44897609338966e-13, 4.5918301751056e-14, 1.83673207004224e-13, 1.63265072892644e-13,
        1.02040670557902e-14, 6.12244023347414e-14, 7.65305029184267e-14, 6.12244023347414e-14, 8.16325364463218e-14, 1.83673207004224e-13, 1.63265072892644e-13, 9.18366035021121e-14, 1.83673207004224e-13, 8.16325364463218e-14,
        2.04081341115805e-14, 4.08162682231609e-14, 9.18366035021121e-14, 1.22448804669483e-13, 0, 1.22448804669483e-13, 1.63265072892644e-13, 9.18366035021121e-14, 2.44897609338966e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 6.12244023347414e-14, 6.12244023347414e-14, 1.22448804669483e-13, 4.08162682231609e-14, 9.18366035021121e-14, 2.04081341115805e-13, 4.5918301751056e-14, 1.83673207004224e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 6.12244023347414e-14, 9.18366035021121e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.53061005836853e-13, 1.22448804669483e-13, 9.18366035021121e-14, 1.83673207004224e-13, 8.16325364463218e-14,
        2.04081341115805e-14, 8.16325364463218e-14, 3.06122011673707e-14, 1.22448804669483e-13, 8.16325364463218e-14, 6.12244023347414e-14, 2.44897609338966e-13, 0, 1.22448804669483e-13, 1.63265072892644e-13,
        2.04081341115805e-14, 8.16325364463218e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.22448804669483e-13, 1.63265072892644e-13, 4.5918301751056e-14, 1.22448804669483e-13, 8.16325364463218e-14,
        2.04081341115805e-14, 8.16325364463218e-14, 9.18366035021121e-14, 4.08162682231609e-14, 8.16325364463218e-14, 1.83673207004224e-13, 8.16325364463218e-14, 9.18366035021121e-14, 1.22448804669483e-13, 0,
        0, 4.08162682231609e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 2.44897609338966e-13, 1.63265072892644e-13, 1.83673207004224e-13, 2.44897609338966e-13, 0,
        1.02040670557902e-14, 4.08162682231609e-14, 9.18366035021121e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.83673207004224e-13, 1.63265072892644e-13, 1.83673207004224e-13, 2.44897609338966e-13, 0,
        1.02040670557902e-14, 6.12244023347414e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.83673207004224e-13, 1.63265072892644e-13, 9.18366035021121e-14, 2.44897609338966e-13, 0,
        1.02040670557902e-14, 6.12244023347414e-14, 9.18366035021121e-14, 4.08162682231609e-14, 8.16325364463218e-14, 2.44897609338966e-13, 8.16325364463218e-14, 1.83673207004224e-13, 1.22448804669483e-13, 0,
        2.04081341115805e-14, 4.08162682231609e-14, 1.22448804669483e-13, 8.16325364463218e-14, 0, 1.22448804669483e-13, 1.63265072892644e-13, 1.83673207004224e-13, 2.44897609338966e-13, 0,
        2.04081341115805e-14, 6.12244023347414e-14, 9.18366035021121e-14, 8.16325364463218e-14, 4.08162682231609e-14, 1.22448804669483e-13, 1.63265072892644e-13, 9.18366035021121e-14, 2.44897609338966e-13, 0,
        2.04081341115805e-14, 6.12244023347414e-14, 1.22448804669483e-13, 4.08162682231609e-14, 4.08162682231609e-14, 1.83673207004224e-13, 8.16325364463218e-14, 1.83673207004224e-13, 1.22448804669483e-13, 0,
        2.04081341115805e-14, 8.16325364463218e-14, 6.12244023347414e-14, 8.16325364463218e-14, 8.16325364463218e-14, 1.22448804669483e-13, 1.63265072892644e-13, 0, 2.44897609338966e-13, 0,
        2.04081341115805e-14, 8.16325364463218e-14, 9.18366035021121e-14, 4.08162682231609e-14, 8.16325364463218e-14, 1.83673207004224e-13, 8.16325364463218e-14, 9.18366035021121e-14, 1.22448804669483e-13, 0,
        2.04081341115805e-14, 8.16325364463218e-14, 1.22448804669483e-13, 0, 8.16325364463218e-14, 2.44897609338966e-13, 0, 1.83673207004224e-13, 0, 0;

    TransitionMatrix expected_matrix_three = TransitionMatrix::Zero(100, 10);

    auto actual_negative = meiosis_diploid_matrix(unequal_mutation_matrix,
                                                  unequal_mutation_matrix, -1);
    boost_check_matrix(expected_matrix_negative, actual_negative);

    auto actual_zero = meiosis_diploid_matrix(unequal_mutation_matrix,
                                              unequal_mutation_matrix, 0);
    boost_check_matrix(expected_matrix_zero, actual_zero);

    auto actual_one = meiosis_diploid_matrix(unequal_mutation_matrix,
                                             unequal_mutation_matrix, 1);
    boost_check_matrix(expected_matrix_one, actual_one);

    auto actual_two = meiosis_diploid_matrix(unequal_mutation_matrix,
                                             unequal_mutation_matrix, 2);
    boost_check_matrix(expected_matrix_two, actual_two);

    auto actual_three = meiosis_diploid_matrix(unequal_mutation_matrix,
                                               unequal_mutation_matrix, 3);
    boost_check_matrix(expected_matrix_three, actual_three);
}

//TODO(SW): Implement the following tests
BOOST_AUTO_TEST_CASE(test_mitosis_haploid_mean_matrix) {
}
BOOST_AUTO_TEST_CASE(test_mitosis_diploid_mean_matrix) {
}
BOOST_AUTO_TEST_CASE(test_meiosis_haploid_mean_matrix) {
}
BOOST_AUTO_TEST_CASE(test_meiosis_diploid_mean_matrix) {
}

BOOST_AUTO_TEST_SUITE_END()

